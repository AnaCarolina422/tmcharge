<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pagamento | ThermoCharge</title>
<link rel="stylesheet" href="style.css">
</head>

<body>

<header class="navbar">
  <div class="tech-buttons">
    <button onclick="window.location.href='index.html'" class="btn-voltar">
        <img src="voltar.png" alt="Voltar" class="icon-btn">
        Voltar ao In√≠cio
    </button>
</div>
</header>

<section style="padding:120px 10%; max-width:900px; margin:auto;">

<h2>Finalizar Pagamento</h2>

<div id="resumo-compra"></div>

<form id="payment-form">

<h3>Forma de Pagamento</h3>

<select id="payment-method" required>
  <option value="">Selecione</option>
  <option value="cartao">Cart√£o de Cr√©dito</option>
  <option value="pix">PIX</option>
  <option value="boleto">Boleto</option>
</select>

<div id="cartao-info" style="display:none; margin-top:20px;">
  <input type="text" placeholder="N√∫mero do Cart√£o" required>
  <input type="text" placeholder="Nome no Cart√£o" required>
  <input type="text" placeholder="Validade (MM/AA)" required>
  <input type="text" placeholder="CVV" required>
</div>

<h3 style="margin-top:30px;">Endere√ßo de Entrega</h3>

<input type="text" placeholder="Nome Completo" required>
<input type="text" placeholder="CPF" required>
<input type="text" placeholder="CEP" required>
<input type="text" placeholder="Rua" required>
<input type="text" placeholder="N√∫mero" required>
<input type="text" placeholder="Complemento">
<input type="text" placeholder="Cidade" required>
<input type="text" placeholder="Estado" required>

<button type="submit" class="btn-primary" style="margin-top:30px;">
Confirmar Pedido
</button>

</form>

</section>

<script>

const resumoDiv = document.getElementById("resumo-compra");

// ===== TENTA PEGAR PELA URL ===== \\
const params = new URLSearchParams(window.location.search);
const totalURL = params.get("total");
const resumoURL = params.get("resumo");

if (totalURL && resumoURL) {

    // Se veio da URL
    resumoDiv.innerHTML = `
        <p>${resumoURL}</p>
        <h3>Total: R$ ${Number(totalURL).toFixed(2)}</h3>
    `;

} else {

    // ===== SEN√ÉO USA LOCALSTORAGE =====
    const cart = JSON.parse(localStorage.getItem("thermoCart")) || [];

    let total = 0;
    resumoDiv.innerHTML = "";

    cart.forEach(item => {

        const preco = parseFloat(item.price);
        const quantidade = item.quantity ? parseInt(item.quantity) : 1;

        const subtotal = preco * quantidade;
        total += subtotal;

        resumoDiv.innerHTML += `
            <p>
              ${item.name} 
              (${quantidade}x) 
              - R$ ${subtotal.toFixed(2)}
            </p>
        `;
    });

    resumoDiv.innerHTML += `<h3>Total: R$ ${total.toFixed(2)}</h3>`;
}

// ===== MOSTRAR CAMPOS DE CART√ÉO =====
document.getElementById("payment-method").addEventListener("change", function() {
  const cartaoInfo = document.getElementById("cartao-info");
  cartaoInfo.style.display = this.value === "cartao" ? "block" : "none";
});

// ===== FINALIZAR =====
document.getElementById("payment-form").addEventListener("submit", function(e){
  e.preventDefault();
  alert("Pedido realizado com sucesso! üöÄ");
  localStorage.removeItem("thermoCart");
  window.location.href = "index.html";
});

function voltarInicio() {
  window.location.href = "index.html";
}
</script>

</body>

</html>


